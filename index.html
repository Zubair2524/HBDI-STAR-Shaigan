<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TLWCLPQSL1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TLWCLPQSL1');
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Let's Understand Yourself (HBDI Personality Test)</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      text-align: center;
      background: linear-gradient(135deg, #007ACC, #009900, #FFD700, #FF3300);
      color: #333;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    .container {
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }
    h1, h2 {
      color: #1a1a1a;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
    }
    h2 {
      animation: pulseText 2s infinite ease-in-out;
    }
    @keyframes pulseText {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    input, button {
      padding: 15px;
      font-size: 1.2rem;
      margin: 0.5rem;
      border-radius: 8px;
      border: none;
      font-weight: bold;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    input {
      background: #f0f0f0;
      width: 80%;
      max-width: 300px;
    }
    button {
      background: #007ACC;
      color: white;
      cursor: pointer;
    }
    button:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    .game-screen, .result-screen {
      display: none;
    }
    .word-box {
      font-size: 2.5rem;
      margin: 1.5rem 0;
      padding: 20px;
      background: linear-gradient(45deg, #007ACC, #FFD700);
      color: white;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      font-weight: bold;
      text-transform: uppercase;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    .scenario-question {
      font-size: 1.5rem;
      font-weight: bold;
      margin: 1rem 0;
      padding: 10px;
      border-radius: 10px;
    }
    .scorecard {
      width: 350px;
      height: 350px;
      border-radius: 50%;
      background: conic-gradient(
        #007ACC 0deg 90deg, /* A - Analytical (Blue) - Top Right */
        #009900 90deg 180deg, /* B - Structural/Planner (Green) - Top Left */
        #FF3300 180deg 270deg, /* C - Relational (Red) - Bottom Left */
        #FFD700 270deg 360deg  /* D - Experimental (Yellow) - Bottom Right */
      );
      position: relative;
      margin: 2rem auto;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }
    .scorecard::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(90deg, red, orange, yellow, green, blue, indigo, violet);
      background-size: 400% 400%;
      animation: glow 5s ease infinite;
      opacity: 0.3;
      z-index: 0;
    }
    @keyframes glow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .scorecard-text {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      color: white;
      text-shadow: 2px 2px 4px #000;
      font-size: 1.5rem;
      z-index: 1;
    }
    .scorecard-text span {
      position: absolute;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.5);
      padding: 5px 10px;
      border-radius: 5px;
    }
    .scorecard-text .a { top: 25%; left: 75%; color: #007ACC; } /* Top Right */
    .scorecard-text .b { top: 25%; left: 25%; color: #009900; } /* Top Left */
    .scorecard-text .c { top: 75%; left: 25%; color: #FF3300; } /* Bottom Left */
    .scorecard-text .d { top: 75%; left: 75%; color: #FFD700; } /* Bottom Right */
    .download-btn, .reset-btn {
      background: #28a745;
      color: white;
      border: none;
      cursor: pointer;
      margin: 1rem;
    }
    .download-btn:hover, .reset-btn:hover {
      background: #218838;
    }
    .rainbow-glow {
      height: 15px;
      width: 100%;
      background: linear-gradient(90deg, red, orange, yellow, green, blue, indigo, violet);
      background-size: 400% 400%;
      animation: glow 5s ease infinite;
      border-radius: 10px;
      margin: 1rem auto;
    }
    .celebration {
      position: absolute;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 2;
    }
    .balloon, .firework {
      position: absolute;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      animation: float 5s linear infinite;
    }
    .balloon {
      background: linear-gradient(45deg, #ff69b4, #ff1493);
    }
    .firework {
      background: linear-gradient(45deg, #ffd700, #ffa500);
      animation: explode 1.5s ease-out infinite;
    }
    @keyframes float {
      0% { bottom: -50px; opacity: 1; }
      100% { bottom: 100%; opacity: 0; }
    }
    @keyframes explode {
      0% { transform: scale(1); opacity: 1; }
      100% { transform: scale(2.5); opacity: 0; }
    }
    .progress-bar {
      width: 80%;
      height: 20px;
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
      margin: 1rem auto;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #007ACC, #FFD700);
      transition: width 0.3s ease;
    }
    .description {
      font-size: 1rem;
      margin: 1rem 0;
      color: #444;
      line-height: 1.5;
    }
    .score-details {
      margin: 1rem 0;
      font-size: 1.2rem;
    }
    .score-details div {
      margin: 0.5rem 0;
    }
    .logo-container {
      margin: 1rem 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .logo-container img {
      max-width: 150px;
      height: auto;
      margin: 0 1rem;
    }
    .praise {
      font-size: 1.8rem;
      font-weight: bold;
      margin: 1rem 0;
      padding: 10px;
      border-radius: 10px;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Welcome Screen -->
    <div class="welcome-screen">
      <h1>HBDI Personality Test Adventure</h1>
      <p class="description">Uncover your unique thinking style by selecting words that resonate with you. Your journey to self-discovery starts here!</p>
      <input type="text" id="name" placeholder="Your Name">
      <input type="text" id="designation" placeholder="Your Designation">
      <input type="text" id="team" placeholder="Your Team">
      <input type="text" id="city" placeholder="Your City">
      <br>
      <button onclick="startGame()">Begin Your Journey</button>
      <div class="rainbow-glow"></div>
    </div>

    <!-- Game Screen -->
    <div class="game-screen">
      <h2>Choose 25 Words for Your HBDI Personality Test</h2>
      <p class="description">Select words that reflect your personality and thinking style. You'll need to choose exactly 25 words.</p>
      <div class="word-box" id="wordBox"></div>
      <div id="scenarioQuestion" class="scenario-question"></div>
      <button onclick="selectWord(true)">Yes, That's Me!</button>
      <button onclick="selectWord(false)">Not Quite</button>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <p>Words Selected: <span id="wordCount">0</span>/25</p>
      <div class="rainbow-glow"></div>
    </div>

    <!-- Result Screen -->
    <div class="result-screen">
      <h2>Congratulations, <span id="userName"></span>! Your HBDI Personality Test Results</h2>
      <p class="description">You've completed the HBDI Personality Test! Your dominant style(s): <span id="dominantType"></span>. Explore your results below!</p>
      <div class="scorecard" id="scoreCard">
        <div class="scorecard-text">
          <span class="a">A</span>
          <span class="b">B</span>
          <span class="c">C</span>
          <span class="d">D</span>
        </div>
        <div class="celebration">
          <div class="balloon" style="left:10%; animation-delay: 0s;"></div>
          <div class="balloon" style="left:30%; animation-delay: 1s;"></div>
          <div class="balloon" style="left:50%; animation-delay: 2s;"></div>
          <div class="balloon" style="left:70%; animation-delay: 3s;"></div>
          <div class="firework" style="left:20%; animation-delay: 0.5s;"></div>
          <div class="firework" style="left:40%; animation-delay: 1.5s;"></div>
          <div class="firework" style="left:60%; animation-delay: 2.5s;"></div>
          <div class="firework" style="left:80%; animation-delay: 3.5s;"></div>
        </div>
      </div>
      <div class="score-details" id="profileScores"></div>
      <div class="praise" id="praiseText"></div>
      <div class="logo-container">
        <!-- Ensure shaigan_pharma_logo.png and star_department_logo.png are in the correct directory on GitHub Pages -->
        <!-- Or update the src with the correct URL, e.g., https://zubair2524.github.io/HBDI-STAR-Shaigan/shaigan_pharma_logo.png -->
        <img src="shaigan_pharma_logo.png" alt="Shaigan Pharma Logo">
        <img src="star_department_logo.png" alt="STAR Department Logo">
      </div>
      <h3 id="userInfo"></h3>
      <button class="download-btn" onclick="downloadScorecard()">Download Your Scorecard</button>
      <button class="reset-btn" onclick="location.reload()">Start Over</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const words = [
      // Analytical (A - Blue) - 50 words
      'Analytical', 'Logical', 'Critical', 'Objective', 'Scientific', 'Rational', 'Insightful', 'Precise', 'Evaluative', 'Factual',
      'Quantitative', 'Methodical', 'Discerning', 'Systematic', 'Reasoned', 'Diagnostic', 'Inquisitive', 'Calculating', 'Intellectual', 'Observant',
      'Perceptive', 'Investigative', 'Data-driven', 'Cautious', 'Reflective', 'Prudent', 'Skeptical', 'Detail-oriented', 'Structured', 'Accurate',
      'Informed', 'Disciplined', 'Meticulous', 'Astute', 'Logical', 'Reasonable', 'Thoughtful', 'Analytical', 'Judicious', 'Empirical',
      'Probing', 'Strategic', 'Decisive', 'Clear-headed', 'Focused', 'Critical-thinking', 'Objective', 'Analytical', 'Rational', 'Precise',

      // Structural/Planner (B - Green) - 50 words
      'Organized', 'Detailed', 'Practical', 'Planner', 'Strategic', 'Stable', 'Methodical', 'Disciplined', 'Structured', 'Systematic',
      'Orderly', 'Efficient', 'Reliable', 'Consistent', 'Procedural', 'Scheduled', 'Punctual', 'Prepared', 'Responsible', 'Dependable',
      'Thorough', 'Sequential', 'Logical', 'Coordinated', 'Pragmatic', 'Task-oriented', 'Controlled', 'Regimented', 'Predictable',
      'Deliberate', 'Cautious', 'Meticulous', 'Structured', 'Organized', 'Detail-focused', 'Systematic', 'Practical', 'Planner', 'Efficient',
      'Reliable', 'Consistent', 'Methodical', 'Orderly', 'Punctual', 'Prepared', 'Responsible', 'Dependable', 'Thorough', 'Sequential',

      // Relational (C - Red) - 50 words
      'Empathetic', 'Compassionate', 'Supportive', 'Collaborative', 'Expressive', 'Listener', 'Mediator', 'Nurturing', 'Harmonious', 'Caring',
      'Warm', 'Sensitive', 'Intuitive', 'Sociable', 'Friendly', 'Team-oriented', 'Empathic', 'Cooperative', 'Considerate', 'Encouraging',
      'Inclusive', 'Sympathetic', 'Affectionate', 'Understanding', 'Approachable', 'Supportive', 'Kind', 'Compassionate', 'Relational', 'Emotional',
      'Engaging', 'Personable', 'Thoughtful', 'Warm-hearted', 'Caring', 'Empathetic', 'Supportive', 'Collaborative', 'Expressive', 'Listener',
      'Mediator', 'Nurturing', 'Harmonious', 'Friendly', 'Team-oriented', 'Cooperative', 'Considerate', 'Encouraging', 'Inclusive', 'Sympathetic',

      // Experimental (D - Yellow) - 50 words
      'Creative', 'Imaginative', 'Visionary', 'Innovative', 'Risk-taking', 'Adventurous', 'Explorer', 'Inspirational', 'Inventive', 'Dynamic',
      'Original', 'Curious', 'Spontaneous', 'Flexible', 'Bold', 'Experimental', 'Visionary', 'Creative', 'Innovative', 'Imaginative',
      'Adventurous', 'Daring', 'Unconventional', 'Inquisitive', 'Open-minded', 'Resourceful', 'Exploratory', 'Future-oriented', 'Big-picture', 'Inspiring',
      'Energetic', 'Playful', 'Improvizational', 'Visionary', 'Creative', 'Innovative', 'Risk-taking', 'Adventurous', 'Explorer', 'Inspirational',
      'Inventive', 'Dynamic', 'Original', 'Curious', 'Spontaneous', 'Flexible', 'Bold', 'Experimental', 'Open-minded', 'Resourceful'
    ];

    const wordQuadrants = {
      // Analytical (A - Blue)
      'Analytical': 'A', 'Logical': 'A', 'Critical': 'A', 'Objective': 'A', 'Scientific': 'A', 'Rational': 'A', 'Insightful': 'A', 'Precise': 'A', 'Evaluative': 'A', 'Factual': 'A',
      'Quantitative': 'A', 'Discerning': 'A', 'Reasoned': 'A', 'Diagnostic': 'A', 'Inquisitive': 'A', 'Calculating': 'A', 'Intellectual': 'A', 'Observant': 'A', 'Perceptive': 'A', 'Investigative': 'A',
      'Data-driven': 'A', 'Cautious': 'A', 'Reflective': 'A', 'Prudent': 'A', 'Skeptical': 'A', 'Detail-oriented': 'A', 'Accurate': 'A', 'Informed': 'A', 'Judicious': 'A', 'Empirical': 'A',
      'Probing': 'A', 'Decisive': 'A', 'Clear-headed': 'A', 'Focused': 'A', 'Critical-thinking': 'A',

      // Structural/Planner (B - Green)
      'Organized': 'B', 'Detailed': 'B', 'Practical': 'B', 'Planner': 'B', 'Strategic': 'B', 'Stable': 'B', 'Methodical': 'B', 'Disciplined': 'B', 'Structured': 'B', 'Systematic': 'B',
      'Orderly': 'B', 'Efficient': 'B', 'Reliable': 'B', 'Consistent': 'B', 'Procedural': 'B', 'Scheduled': 'B', 'Punctual': 'B', 'Prepared': 'B', 'Responsible': 'B', 'Dependable': 'B',
      'Thorough': 'B', 'Sequential': 'B', 'Coordinated': 'B', 'Pragmatic': 'B', 'Task-oriented': 'B', 'Controlled': 'B', 'Regimented': 'B', 'Predictable': 'B', 'Deliberate': 'B', 'Detail-focused': 'B',

      // Relational (C - Red)
      'Empathetic': 'C', 'Compassionate': 'C', 'Supportive': 'C', 'Collaborative': 'C', 'Expressive': 'C', 'Listener': 'C', 'Mediator': 'C', 'Nurturing': 'C', 'Harmonious': 'C', 'Caring': 'C',
      'Warm': 'C', 'Sensitive': 'C', 'Intuitive': 'C', 'Sociable': 'C', 'Friendly': 'C', 'Team-oriented': 'C', 'Empathic': 'C', 'Cooperative': 'C', 'Considerate': 'C', 'Encouraging': 'C',
      'Inclusive': 'C', 'Sympathetic': 'C', 'Affectionate': 'C', 'Understanding': 'C', 'Approachable': 'C', 'Kind': 'C', 'Relational': 'C', 'Emotional': 'C', 'Engaging': 'C', 'Personable': 'C',
      'Thoughtful': 'C', 'Warm-hearted': 'C',

      // Experimental (D - Yellow)
      'Creative': 'D', 'Imaginative': 'D', 'Visionary': 'D', 'Innovative': 'D', 'Risk-taking': 'D', 'Adventurous': 'D', 'Explorer': 'D', 'Inspirational': 'D', 'Inventive': 'D', 'Dynamic': 'D',
      'Original': 'D', 'Curious': 'D', 'Spontaneous': 'D', 'Flexible': 'D', 'Bold': 'D', 'Experimental': 'D', 'Daring': 'D', 'Unconventional': 'D', 'Inquisitive': 'D', 'Open-minded': 'D',
      'Resourceful': 'D', 'Exploratory': 'D', 'Future-oriented': 'D', 'Big-picture': 'D', 'Inspiring': 'D', 'Energetic': 'D', 'Playful': 'D', 'Improvizational': 'D'
    };

    const scenarios = {
      // Analytical (A - Blue)
      'Analytical': '<strong>Would you enjoy breaking down a complex problem into smaller parts to find a logical solution?</strong>',
      'Logical': '<strong>Would you prefer to make decisions based on a step-by-step, rational process?</strong>',
      'Critical': '<strong>Would you feel comfortable questioning assumptions to ensure accuracy in a project?</strong>',
      'Objective': '<strong>Would you focus on facts and data rather than emotions when analyzing a situation?</strong>',
      'Scientific': '<strong>Would you enjoy conducting experiments to test a hypothesis?</strong>',
      'Rational': '<strong>Would you rely on reason over intuition to solve a challenging task?</strong>',
      'Insightful': '<strong>Would you like to uncover hidden patterns in a set of numbers or data?</strong>',
      'Precise': '<strong>Would you take extra care to ensure every detail in a report is exact?</strong>',
      'Evaluative': '<strong>Would you enjoy assessing the pros and cons of a business strategy?</strong>',
      'Factual': '<strong>Would you base your arguments on verifiable evidence rather than opinions?</strong>',
      'Quantitative': '<strong>Would you feel confident working with statistics to draw conclusions?</strong>',
      'Methodical': '<strong>Would you follow a structured approach to complete a research task?</strong>',
      'Discerning': '<strong>Would you carefully judge the quality of different options before deciding?</strong>',
      'Systematic': '<strong>Would you organize your work in a clear, step-by-step manner?</strong>',
      'Reasoned': '<strong>Would you use logical arguments to persuade others in a discussion?</strong>',
      'Diagnostic': '<strong>Would you enjoy identifying the cause of a technical issue?</strong>',
      'Inquisitive': '<strong>Would you ask deep questions to understand how something works?</strong>',
      'Calculating': '<strong>Would you carefully calculate risks before making a financial decision?</strong>',
      'Intellectual': '<strong>Would you enjoy engaging in a debate about complex ideas?</strong>',
      'Observant': '<strong>Would you notice small details others might overlook in a meeting?</strong>',
      'Perceptive': '<strong>Would you pick up on subtle trends in data over time?</strong>',
      'Investigative': '<strong>Would you enjoy digging into research to solve a mystery?</strong>',
      'Data-driven': '<strong>Would you rely on data analysis to guide your business decisions?</strong>',
      'Cautious': '<strong>Would you double-check your work to avoid errors?</strong>',
      'Reflective': '<strong>Would you take time to think deeply before responding to a problem?</strong>',
      'Prudent': '<strong>Would you make careful choices to avoid unnecessary risks?</strong>',
      'Skeptical': '<strong>Would you question new ideas until you have solid proof?</strong>',
      'Detail-oriented': '<strong>Would you focus on perfecting the small details of a project?</strong>',
      'Structured': '<strong>Would you prefer a well-organized plan for every task?</strong>',
      'Accurate': '<strong>Would you ensure all your calculations are correct before presenting?</strong>',
      'Informed': '<strong>Would you gather all relevant facts before making a judgment?</strong>',
      'Disciplined': '<strong>Would you stick to a strict schedule to meet deadlines?</strong>',
      'Meticulous': '<strong>Would you carefully review every aspect of a document?</strong>',
      'Astute': '<strong>Would you quickly spot a flaw in a logical argument?</strong>',
      'Judicious': '<strong>Would you make wise decisions after thorough analysis?</strong>',
      'Empirical': '<strong>Would you trust evidence from experiments over guesses?</strong>',
      'Probing': '<strong>Would you ask detailed questions to get to the root of an issue?</strong>',
      'Decisive': '<strong>Would you make a clear choice after evaluating all options?</strong>',
      'Clear-headed': '<strong>Would you stay calm and focused during a crisis?</strong>',
      'Focused': '<strong>Would you concentrate deeply on solving a single problem?</strong>',
      'Critical-thinking': '<strong>Would you analyze a situation from multiple angles before deciding?</strong>',

      // Structural/Planner (B - Green)
      'Organized': '<strong>Would you create a detailed plan before starting a big project?</strong>',
      'Detailed': '<strong>Would you include every step in a schedule for an event?</strong>',
      'Practical': '<strong>Would you choose the most efficient way to complete a task?</strong>',
      'Planner': '<strong>Would you enjoy mapping out a timeline for a team goal?</strong>',
      'Strategic': '<strong>Would you develop a long-term plan for company growth?</strong>',
      'Stable': '<strong>Would you prefer a consistent routine in your workday?</strong>',
      'Methodical': '<strong>Would you follow a step-by-step process to organize a meeting?</strong>',
      'Disciplined': '<strong>Would you stick to a strict budget for a project?</strong>',
      'Structured': '<strong>Would you set up a clear framework for a new system?</strong>',
      'Systematic': '<strong>Would you use a checklist to ensure all tasks are done?</strong>',
      'Orderly': '<strong>Would you keep your workspace neat and organized?</strong>',
      'Efficient': '<strong>Would you streamline a process to save time?</strong>',
      'Reliable': '<strong>Would you always meet deadlines you commit to?</strong>',
      'Consistent': '<strong>Would you maintain the same high standard every day?</strong>',
      'Procedural': '<strong>Would you follow a set procedure for handling complaints?</strong>',
      'Scheduled': '<strong>Would you plan your week with a detailed calendar?</strong>',
      'Punctual': '<strong>Would you always arrive on time for appointments?</strong>',
      'Prepared': '<strong>Would you have a backup plan ready for any situation?</strong>',
      'Responsible': '<strong>Would you take ownership of a team project’s success?</strong>',
      'Dependable': '<strong>Would others count on you to deliver on promises?</strong>',
      'Thorough': '<strong>Would you review every detail before submitting a report?</strong>',
      'Sequential': '<strong>Would you complete tasks in a specific order every time?</strong>',
      'Coordinated': '<strong>Would you organize a team effort with clear roles?</strong>',
      'Pragmatic': '<strong>Would you focus on realistic solutions over ideal ones?</strong>',
      'Task-oriented': '<strong>Would you prioritize completing tasks over socializing?</strong>',
      'Controlled': '<strong>Would you manage a project with strict oversight?</strong>',
      'Regimented': '<strong>Would you follow a strict daily routine without deviation?</strong>',
      'Predictable': '<strong>Would you prefer a work environment with set expectations?</strong>',
      'Deliberate': '<strong>Would you take time to plan each step of a task?</strong>',
      'Detail-focused': '<strong>Would you ensure no minor detail is overlooked in planning?</strong>',

      // Relational (C - Red)
      'Empathetic': '<strong>Would you feel others’ emotions and offer support during a tough time?</strong>',
      'Compassionate': '<strong>Would you help a struggling colleague with kindness?</strong>',
      'Supportive': '<strong>Would you encourage a friend to pursue their goals?</strong>',
      'Collaborative': '<strong>Would you work closely with a team to solve a problem?</strong>',
      'Expressive': '<strong>Would you share your feelings openly in a conversation?</strong>',
      'Listener': '<strong>Would you patiently hear someone out before responding?</strong>',
      'Mediator': '<strong>Would you help resolve a conflict between two people?</strong>',
      'Nurturing': '<strong>Would you guide a new team member with care?</strong>',
      'Harmonious': '<strong>Would you strive to keep peace in a group setting?</strong>',
      'Caring': '<strong>Would you check in on a friend who seems upset?</strong>',
      'Warm': '<strong>Would you greet others with a friendly smile every day?</strong>',
      'Sensitive': '<strong>Would you notice when someone is feeling down?</strong>',
      'Intuitive': '<strong>Would you sense someone’s needs without them saying it?</strong>',
      'Sociable': '<strong>Would you enjoy chatting with new people at a gathering?</strong>',
      'Friendly': '<strong>Would you make others feel welcome in a new group?</strong>',
      'Team-oriented': '<strong>Would you put team success above personal gain?</strong>',
      'Empathic': '<strong>Would you understand a coworker’s challenges and offer help?</strong>',
      'Cooperative': '<strong>Would you work together to achieve a common goal?</strong>',
      'Considerate': '<strong>Would you think about others’ feelings before acting?</strong>',
      'Encouraging': '<strong>Would you motivate a friend to try again after a failure?</strong>',
      'Inclusive': '<strong>Would you ensure everyone feels part of the team?</strong>',
      'Sympathetic': '<strong>Would you feel sorry for someone’s misfortune and help?</strong>',
      'Affectionate': '<strong>Would you show love or care through a hug or kind words?</strong>',
      'Understanding': '<strong>Would you accept someone’s mistakes with patience?</strong>',
      'Approachable': '<strong>Would you others feel comfortable asking you for advice?</strong>',
      'Kind': '<strong>Would you offer help to a stranger in need?</strong>',
      'Relational': '<strong>Would you build strong connections with your colleagues?</strong>',
      'Emotional': '<strong>Would you express your feelings openly in a close relationship?</strong>',
      'Engaging': '<strong>Would you make a conversation lively and interactive?</strong>',
      'Personable': '<strong>Would you easily connect with people on a personal level?</strong>',
      'Thoughtful': '<strong>Would you remember a friend’s birthday with a gift?</strong>',
      'Warm-hearted': '<strong>Would you show genuine care in every interaction?</strong>',

      // Experimental (D - Yellow)
      'Creative': '<strong>Would you design a unique solution for a common problem?</strong>',
      'Imaginative': '<strong>Would you come up with a new story idea for a book?</strong>',
      'Visionary': '<strong>Would you dream up a bold plan for the future of your company?</strong>',
      'Innovative': '<strong>Would you invent a new way to use an old tool?</strong>',
      'Risk-taking': '<strong>Would you try a new approach even if it might fail?</strong>',
      'Adventurous': '<strong>Would you explore an unfamiliar place on a trip?</strong>',
      'Explorer': '<strong>Would you seek out new experiences in your free time?</strong>',
      'Inspirational': '<strong>Would you motivate others with a creative idea?</strong>',
      'Inventive': '<strong>Would you build a prototype for a new gadget?</strong>',
      'Dynamic': '<strong>Would you bring energy to a stagnant team project?</strong>',
      'Original': '<strong>Would you create something no one has thought of before?</strong>',
      'Curious': '<strong>Would you ask questions to learn about a new topic?</strong>',
      'Spontaneous': '<strong>Would you decide to travel on a sudden whim?</strong>',
      'Flexible': '<strong>Would you adapt quickly to an unexpected change?</strong>',
      'Bold': '<strong>Would you take a daring step to achieve a goal?</strong>',
      'Experimental': '<strong>Would you test a new method to improve a process?</strong>',
      'Daring': '<strong>Would you attempt a challenging task others avoid?</strong>',
      'Unconventional': '<strong>Would you try a non-traditional approach to a problem?</strong>',
      'Inquisitive': '<strong>Would you explore beyond the basics to learn more?</strong>',
      'Open-minded': '<strong>Would you consider a wild idea with an open perspective?</strong>',
      'Resourceful': '<strong>Would you find a creative way to solve a resource shortage?</strong>',
      'Exploratory': '<strong>Would you investigate new possibilities in a project?</strong>',
      'Future-oriented': '<strong>Would you plan for trends five years from now?</strong>',
      'Big-picture': '<strong>Would you focus on the overall vision rather than details?</strong>',
      'Inspiring': '<strong>Would you spark enthusiasm with a new concept?</strong>',
      'Energetic': '<strong>Would you bring lively energy to a brainstorming session?</strong>',
      'Playful': '<strong>Would you add fun elements to a serious task?</strong>',
      'Improvizational': '<strong>Would you adapt on the spot during a presentation?</strong>'
    };

    let userInfo = {};
    let selectedWords = [];
    let availableWords = [...words]; // Start with full list

    function startGame() {
      userInfo = {
        name: document.getElementById('name').value || 'Thinker',
        designation: document.getElementById('designation').value || 'Explorer',
        team: document.getElementById('team').value || 'Dream Team',
        city: document.getElementById('city').value || 'Mind City'
      };
      document.querySelector('.welcome-screen').style.display = 'none';
      document.querySelector('.game-screen').style.display = 'block';
      shuffleArray(availableWords);
      showNextWord();
    }

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function showNextWord() {
      if (selectedWords.length < 25 && availableWords.length > 0) {
        const word = availableWords.pop(); // Remove and get the last word
        document.getElementById('wordBox').innerText = word;
        document.getElementById('scenarioQuestion').innerHTML = scenarios[word] || '<strong>No scenario available for this word.</strong>';
        updateProgress();
      } else if (selectedWords.length < 25) {
        alert("Not enough unique words available to select 25. Please restart and try again.");
        location.reload();
      } else {
        showResults();
      }
    }

    function updateProgress() {
      const progress = (selectedWords.length / 25) * 100;
      document.getElementById('progressFill').style.width = `${progress}%`;
    }

    function selectWord(selected) {
      if (selected) {
        selectedWords.push(availableWords[availableWords.length - 1]); // Add the word they said Yes to
      }
      // Word is already removed from availableWords by showNextWord
      document.getElementById('wordCount').innerText = selectedWords.length;

      if (selectedWords.length >= 25) {
        showResults();
      } else {
        showNextWord();
      }
    }

    function showResults() {
      document.querySelector('.game-screen').style.display = 'none';
      document.querySelector('.result-screen').style.display = 'block';

      const quadrantScores = { A: 0, B: 0, C: 0, D: 0 };
      selectedWords.forEach(word => {
        const quadrant = wordQuadrants[word];
        quadrantScores[quadrant] += 4; // Each word contributes 4 marks
      });

      const totalScore = 100; // Total marks = 25 words * 4 = 100, normalized to 100%

      const percentages = {
        A: Math.round((quadrantScores.A / totalScore) * 100),
        B: Math.round((quadrantScores.B / totalScore) * 100),
        C: Math.round((quadrantScores.C / totalScore) * 100),
        D: Math.round((quadrantScores.D / totalScore) * 100)
      };

      // Ensure percentages sum to 100% (adjust if rounding causes slight deviation)
      const sum = percentages.A + percentages.B + percentages.C + percentages.D;
      if (sum !== 100) {
        const diff = 100 - sum;
        percentages.A += diff; // Adjust the highest quadrant to compensate
      }

      document.getElementById('profileScores').innerHTML =
        `<div style="color: #007ACC;">Analytical (A - Blue): ${percentages.A}%</div>
         <div style="color: #009900;">Structural/Planner (B - Green): ${percentages.B}%</div>
         <div style="color: #FF3300;">Relational (C - Red): ${percentages.C}%</div>
         <div style="color: #FFD700;">Experimental (D - Yellow): ${percentages.D}%</div>`;

      document.getElementById('userInfo').innerText = `${userInfo.name}, ${userInfo.designation}, STAR - Shaigan Training and Reinforcement, ${userInfo.team}, ${userInfo.city}`;

      document.getElementById('userName').innerText = userInfo.name;

      const actionWords = {
        A: 'Analytical (A - Blue)',
        B: 'Structural/Planner (B - Green)',
        C: 'Relational (C - Red)',
        D: 'Experimental (D - Yellow)'
      };

      const maxPercentage = Math.max(...Object.values(percentages));
      const dominantStyles = Object.entries(percentages)
        .filter(([_, value]) => value === maxPercentage)
        .map(([key]) => actionWords[key]);

      document.getElementById('dominantType').innerText = dominantStyles.join(' and ');

      // Praise based on dominant styles
      let praiseText = '';
      if (dominantStyles.includes('Analytical (A - Blue)')) {
        praiseText += '<span style="color: #007ACC;">Your analytical mind is a true asset! Your ability to dissect complex problems with precision and logic is remarkable.</span><br>';
      }
      if (dominantStyles.includes('Structural/Planner (B - Green)')) {
        praiseText += '<span style="color: #009900;">Your organizational skills are outstanding! Your knack for creating structured plans ensures success every time.</span><br>';
      }
      if (dominantStyles.includes('Relational (C - Red)')) {
        praiseText += '<span style="color: #FF3300;">Your warmth and empathy shine brightly! Your ability to connect and support others is truly inspiring.</span><br>';
      }
      if (dominantStyles.includes('Experimental (D - Yellow)')) {
        praiseText += '<span style="color: #FFD700;">Your creativity knows no bounds! Your innovative spirit and bold ideas light up every challenge.</span><br>';
      }
      if (dominantStyles.length > 1) {
        praiseText += '<span style="color: #000;">Your versatility across multiple styles makes you an exceptional all-rounder!</span><br>';
      }
      document.getElementById('praiseText').innerHTML = praiseText;

      // Send data to Google Sheets
      sendToGoogleSheets(userInfo, selectedWords, quadrantScores, percentages, dominantStyles);
    }

    function downloadScorecard() {
      html2canvas(document.querySelector('.result-screen'), { scale: 2 }).then(canvas => {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const imgData = canvas.toDataURL('image/png');
        const imgProps = pdf.getImageProperties(imgData);
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
        pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
        pdf.save(`${userInfo.name}_HBDI_Scorecard.pdf`);
      });
    }

    // Function to send data to Google Sheets
    async function sendToGoogleSheets(userInfo, selectedWords, quadrantScores, percentages, dominantStyles) {
      // Update this URL with the new Web App URL if it changes after redeployment
      const googleSheetsUrl = "https://script.google.com/macros/s/AKfycbwvoSa7b8mVu_kAOM3o-6Frpx-ygS3NmG-G0GRkff7bEz9eXLcdWS9gbAlwgrgjgh8sSQ/exec";
      const timestamp = new Date().toISOString();
      const data = {
        userInfo: {
          name: userInfo.name || "",
          designation: userInfo.designation || "",
          team: userInfo.team || "",
          city: userInfo.city || ""
        },
        selectedWords: selectedWords || [],
        quadrantScores: quadrantScores || { A: 0, B: 0, C: 0, D: 0 },
        percentages: percentages || { A: 0, B: 0, C: 0, D: 0 },
        dominantStyles: dominantStyles || [],
        timestamp: timestamp
      };

      console.log("Sending data to Google Sheets:", JSON.stringify(data, null, 2));

      try {
        const response = await fetch(googleSheetsUrl, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data),
          mode: "cors",
          credentials: "omit"
        });

        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status} ${response.statusText}`);
        }

        const result = await response.json();
        console.log("Google Sheets Response:", result);

        if (result.status === "success") {
          alert("Your data has been successfully saved to Google Sheets!");
        } else {
          console.error("Google Sheets error response:", result);
          alert(`Error saving data to Google Sheets: ${result.message}`);
        }
      } catch (error) {
        console.error("Error sending to Google Sheets:", error);
        const errorMessage = error.message.includes("Failed to fetch")
          ? `Error: Failed to connect to Google Sheets. Please ensure the Google Apps Script Web App is deployed with 'Anyone' access and the URL is correct. If hosted on GitHub Pages (https://zubair2524.github.io), verify the Web App allows CORS requests. Error details: ${error.message}`
          : `Error sending data to Google Sheets: ${error.message}. Please check the browser console for details.`;
        alert(errorMessage);
      }
    }
  </script>
</body>
</html>
